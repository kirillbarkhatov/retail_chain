# Онлайн-платформа торговой сети электроники (в разработке)

[//]: # ()
[//]: # (## Описание:)

[//]: # ()
[//]: # (Сервис позволяет пользователям регистрироваться и авторизовываться по номеру телефона, а также использовать и распространять инвайт-коды. )

[//]: # ()
[//]: # (## Установка, настройка и запуск:)

[//]: # ()
[//]: # (Проект построен на следующем стеке:)

[//]: # (* Django/DRF)

[//]: # (* OpenAPI Docs)

[//]: # (* PostgreSQL)

[//]: # (* Redis)

[//]: # (* Docker)

[//]: # (* smsaero.ru &#40;платный сервис рассылки смс&#41;)

[//]: # (* Bootstrap &#40;для тестирования функционала&#41;)

[//]: # ()
[//]: # (Ссылка для добавления проекта:)

[//]: # ([git@github.com:kirillbarkhatov/AuthMobile.git]&#40;&#41;)

[//]: # ()
[//]: # (### НАСТРОЙКИ `.env`)

[//]: # ()
[//]: # (Из шаблона `.env.sample` создайте файл `.env`)

[//]: # ()
[//]: # (#### DJANGO)

[//]: # ()
[//]: # (Укажите ваш ключ джанго)

[//]: # ()
[//]: # (`SECRET_KEY=`)

[//]: # ()
[//]: # (Укажите режим работы `True` или `False`)

[//]: # ()
[//]: # (`DEBUG=`)

[//]: # ()
[//]: # (#### БД)

[//]: # ()
[//]: # (Для проекта используется `PostgreSQL`. Настройте ваши параметры, предварительно, при необходимости, создав пустую БД)

[//]: # ()
[//]: # (`POSTGRES_DB=`)

[//]: # ()
[//]: # (`POSTGRES_USER=`)

[//]: # ()
[//]: # (`POSTGRES_PASSWORD=`)

[//]: # ()
[//]: # (`POSTGRES_HOST=`)

[//]: # ()
[//]: # (`POSTGRES_PORT=`)

[//]: # ()
[//]: # (Для тестирования можно использовать фикстуры - заполните БД тестовыми данными, используя команду `python3 manage.py add_test_data`.)

[//]: # ()
[//]: # (После этого выполните `python3 manage.py csu` чтобы создать суперюзера.)

[//]: # ()
[//]: # (#### SMS AERO)

[//]: # ()
[//]: # (Внесите токен в `.env`.)

[//]: # ()
[//]: # (Токен можно получить в настройках в личном кабинете после регистрации на сайте [smsaero.ru]&#40;&#41;)

[//]: # ()
[//]: # (`SMSAERO_API_KEY=`)

[//]: # ()
[//]: # (Внимание!!! В Тестовом режиме код выводится в консоль &#40;для апи&#41; или отображается на экране, если входить в браузере.)

[//]: # (Функция отправки смс закомментирована непосредственно в контроллере.)

[//]: # ()
[//]: # (#### Настройки redis)

[//]: # ()
[//]: # (Проект использует кеширование для временного хранения кодов авторизации. Стандартные настройки для локального запуска ниже)

[//]: # ()
[//]: # (`CACHE_ENABLED=True`)

[//]: # ()
[//]: # (`LOCATION=redis://127.0.0.1:6379/1`)

[//]: # ()
[//]: # (### ЗАПУСК)

[//]: # ()
[//]: # (Используйте `Docker`.)

[//]: # ()
[//]: # (#### Сборка и запуск проекта с Docker Compose)

[//]: # (Для запуска проекта с использованием Docker Compose выполните следующую команду:)

[//]: # (`docker-compose up --build`)

[//]: # ()
[//]: # (#### Команды для управления)

[//]: # ()
[//]: # (`docker-compose up -d` - запустит контейнеры в фоновом режиме)

[//]: # ()
[//]: # (`docker-compose down` — останавливает все работающие контейнеры и удаляет контейнеры, сети, тома и образы, созданные командой)

[//]: # ()
[//]: # (`docker-compose logs` — позволяет просматривать логи всех контейнеров. Это полезно для отладки и мониторинга работы контейнеров.)

[//]: # ()
[//]: # (`docker-compose ps` — выводит список всех контейнеров, созданных Docker Compose, и их текущее состояние)

[//]: # ()
[//]: # (### Развертывание на сервере)

[//]: # ()
[//]: # (Форкните репозиторий)

[//]: # ()
[//]: # (Подготовьте удаленный сервер к работе, установите git )

[//]: # ()
[//]: # (`sudo apt update` )

[//]: # ()
[//]: # (`sudo apt install git`)

[//]: # ()
[//]: # (и докер - инструкция - [https://docs.docker.com/engine/install/ubuntu/#install-using-the-repository]&#40;&#41;)

[//]: # ()
[//]: # (Перенесите все параметры из `.env` в секреты, а также добавьте следующие свои секреты докер хаба и сервера)

[//]: # ()
[//]: # (`DOCKER_HUB_ACCESS_TOKEN`)

[//]: # ()
[//]: # (`DOCKER_HUB_USERNAME`)

[//]: # ()
[//]: # (`SERVER_IP`)

[//]: # ()
[//]: # (`SSH_KEY`)

[//]: # ()
[//]: # (`SSH_USER`)

[//]: # ()
[//]: # (Запуште любой коммит и приложение целиком развернётся на вашем сервере)

[//]: # ()
[//]: # (## Использование:)

[//]: # ()
[//]: # (Сервис предоставляет следующие эндпоинты)

[//]: # ()
[//]: # (`GET` `api/profile/` - Эндпоинт для получения информации о пользователе.)

[//]: # ()
[//]: # (В запросе необходимо передать авторизационные данные `Authorization=Bearer _ваш_токен_`)

[//]: # ()
[//]: # (Формат ответа:)

[//]: # (```sh)

[//]: # ({)

[//]: # (  "id": 0,)

[//]: # (  "phone": "string",)

[//]: # (  "invite_code": "string",)

[//]: # (  "invited_by_user": {)

[//]: # (    "id": 0,)

[//]: # (    "phone": "string",)

[//]: # (    "invite_code": "string")

[//]: # (  },)

[//]: # (  "created_at": "2019-08-24T14:15:22Z",)

[//]: # (  "invited_users": [)

[//]: # (    {)

[//]: # (      "id": 0,)

[//]: # (      "phone": "string")

[//]: # (    })

[//]: # (  ])

[//]: # (})

[//]: # (```)

[//]: # ()
[//]: # (`POST` `api/register/` - Эндпоинт для регистрации и/или авторизации пользователя. Ожидает номер телефона и, опционально, инвайт-код. Проверяет, существует ли пользователь, создаёт его при необходимости. Генерирует код подтверждения и отправляет его пользователю.)

[//]: # ()
[//]: # (Формат запроса)

[//]: # (```sh)

[//]: # ({)

[//]: # (    "phone": "string",)

[//]: # (    "invited_by": "string")

[//]: # (})

[//]: # (```)

[//]: # ()
[//]: # (`POST` `api/token/refresh/` - Эндпоинт для обновления токена)

[//]: # ()
[//]: # (Формат запроса)

[//]: # (```sh)

[//]: # ({)

[//]: # ("refresh": "string")

[//]: # (})

[//]: # (```)

[//]: # ()
[//]: # (Формат ответа)

[//]: # (```sh)

[//]: # ({)

[//]: # ("refresh": "string",)

[//]: # ("access": "string")

[//]: # (})

[//]: # (```)

[//]: # ()
[//]: # (`POST` `api/verify/` - Эндпоинт для проверки кода подтверждения. Ожидает номер телефона и код подтверждения. Проверяет корректность кода и, в случае успеха, выдаёт JWT-токены.)

[//]: # ()
[//]: # (Формат запроса)

[//]: # (```sh)

[//]: # ({)

[//]: # (    "phone": "string",)

[//]: # (    "code": "string")

[//]: # (})

[//]: # (```)

[//]: # ()
[//]: # (Формат ответа)

[//]: # (```sh)

[//]: # ({)

[//]: # ("refresh": "string",)

[//]: # ("access": "string")

[//]: # (})

[//]: # (```)

[//]: # ()
[//]: # ()
[//]: # (## Функционал)

[//]: # ()
[//]: # (1. **Авторизация по номеру телефона:** )

[//]: # (   - Пользователь вводит свой номер телефона для авторизации.)

[//]: # (   - Пользователь вводит полученный код для завершения процесса авторизации.)

[//]: # (   - Если пользователь ранее не авторизовывался, его данные записываются в базу данных.)

[//]: # ()
[//]: # (2. **Запрос на профиль пользователя:** )

[//]: # (   - При первой авторизации пользователю присваивается случайно сгенерированный 6-значный инвайт-код, состоящий из цифр и символов.)

[//]: # (   - В профиле у пользователя есть возможность ввести чужой инвайт-код, при этом проверяется его существование в системе.)

[//]: # (   - В профиле можно активировать только один инвайт-код. Если пользователь уже активировал инвайт-код, он должен отображаться в соответствующем поле при запросе профиля пользователя.)

[//]: # (   - API профиля выводит список пользователей &#40;номеров телефона&#41;, которые ввели инвайт-код текущего пользователя.)

[//]: # (3. **Интерфейс:** )

[//]: # (   - Реализован интерфейс на Django Templates для базового тестирования функционала.)

[//]: # ()
[//]: # ()
[//]: # (## Лицензия:)

[//]: # ()
[//]: # (Этот проект лицензирован по [лицензии MIT]&#40;LICENSE&#41;.)